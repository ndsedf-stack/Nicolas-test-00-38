<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Planetaire - HYBRID MASTER 51</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
      body {
        font-family: 'Inter', sans-serif;
        background: linear-gradient(180deg, #06070a 0%, #080b12 100%);
      }
      /* Custom scrollbar for webkit browsers */
      ::-webkit-scrollbar {
        width: 8px;
      }
      ::-webkit-scrollbar-track {
        background: #0d111a;
      }
      ::-webkit-scrollbar-thumb {
        background: #f59e0b;
        border-radius: 4px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #ff8a00;
      }
    </style>
  <script type="importmap">
{
  "imports": {
    "recharts": "https://aistudiocdn.com/recharts@^3.3.0",
    "react": "https://aistudiocdn.com/react@^19.2.0",
    "react/": "https://aistudiocdn.com/react@^19.2.0/",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.0/"
  }
}
</script>
</head>
  <body class="bg-[#080b12] text-white">
    <div id="root"></div>
    <script type="module">
// --- BUNDLED SCRIPT START ---

import React, { useState, useEffect, useCallback, useMemo, useRef } from 'react';
import ReactDOM from 'react-dom/client';
import { BarChart, Bar, XAxis, YAxis, Tooltip, Legend, ResponsiveContainer, RadarChart, PolarGrid, PolarAngleAxis, PolarRadiusAxis, Radar } from 'recharts';

// --- From constants.ts ---
const MUSCLE_MAPPING = {
  "Trap Bar Deadlift": { primary:["Ischios","Fessiers","Dos"], secondary:["Quadriceps","Abdominaux"], tertiary:["Mollets","Avant-bras"] },
  "Goblet Squat": { primary:["Quadriceps","Fessiers"], secondary:["Ischios","Abdominaux"], tertiary:["Mollets"] },
  "Leg Press": { primary:["Quadriceps","Ischios"], secondary:["Fessiers"], tertiary:["Mollets"] },
  "Lat Pulldown": { primary:["Dos"], secondary:["Biceps"], tertiary:["Avant-bras"] },
  "Landmine Press": { primary:["Épaules","Triceps"], secondary:["Pectoraux"], tertiary:[] },
  "Rowing Machine": { primary:["Dos"], secondary:["Biceps"], tertiary:["Avant-bras"] },
  "Spider Curl": { primary:["Biceps"], secondary:["Avant-bras"], tertiary:[] },
  "Incline Curl": { primary:["Biceps"], secondary:["Avant-bras"], tertiary:[] },
  "Spider Curl / Incline Curl*": { primary:["Biceps"], secondary:["Avant-bras"], tertiary:[] },
  "Cable Pushdown": { primary:["Triceps"], secondary:["Avant-bras"], tertiary:[] },
  "Dumbbell Press": { primary:["Pectoraux"], secondary:["Triceps","Épaules"], tertiary:[] },
  "Cable Fly": { primary:["Pectoraux"], secondary:[], tertiary:[] },
  "Leg Press léger": { primary:["Quadriceps"], secondary:["Ischios","Fessiers"], tertiary:["Mollets"] },
  "Extension Triceps Corde": { primary:["Triceps"], secondary:["Avant-bras"], tertiary:[] },
  "Lateral Raises": { primary:["Épaules latérales"], secondary:["Trapèzes"], tertiary:[] },
  "Face Pull": { primary:["Épaules postérieures","Trapèzes"], secondary:["Dos"], tertiary:[] },
  "Overhead Extension": { primary:["Triceps longs"], secondary:[], tertiary:[] },
  "Landmine Row": { primary:["Dos"], secondary:["Biceps"], tertiary:["Avant-bras"] },
  "Leg Curl": { primary:["Ischios"], secondary:["Fessiers"], tertiary:["Mollets"] },
  "Leg Extension": { primary:["Quadriceps"], secondary:[], tertiary:[] },
  "Dumbbell Fly": { primary:["Pectoraux"], secondary:["Épaules"], tertiary:[] },
  "EZ Bar Curl": { primary:["Biceps"], secondary:["Avant-bras"], tertiary:[] },
  "Wrist Curl": { primary:["Avant-bras"], secondary:[], tertiary:[] },
  "Hammer Curl": { primary:["Biceps","Avant-bras"], secondary:[], tertiary:[] }
};
const PROGRAM = {
  dimanche: {
    key:'dimanche', 
    title: "Dimanche - Dos + Jambes Lourdes + Bras (68 min)",
    exercises:[
      { name:"Trap Bar Deadlift", sets:5, reps:"6-8", rest:120, weight:75, type:"barre", tech:"RPE 6-8" },
      { name:"Goblet Squat", sets:4, reps:"10", rest:75, weight:25, type:"haltères", tech:"Tempo 3-1-2" },
      { name:"Leg Press", sets:4, reps:"10", rest:75, weight:110, type:"machine", tech:"Drop-set dernière série" },
      { name:"Lat Pulldown", sets:4, reps:"10", rest:90, weight:60, type:"machine", tech:"Myo-reps" },
      { name:"Landmine Press", sets:4, reps:"10", rest:90, weight:35, type:"barre", tech:"Tempo 2-1-2" },
      { name:"Rowing Machine", sets:4, reps:"10", rest:75, weight:50, type:"machine", tech:"Tempo 2-1-2" },
      { name:"Spider Curl / Incline Curl*", sets:4, reps:"12", rest:75, weight:12, type:"haltères", tech:"Rest-pause" },
      { name:"Cable Pushdown", sets:3, reps:"12", rest:75, weight:20, type:"machine", tech:"Rest-pause" }
    ]
  },
  mardi: {
    key:'mardi', 
    title:"Mardi - Pecs + Épaules + Triceps (70 min)",
    exercises:[
      { name:"Dumbbell Press", sets:5, reps:"10", rest:105, weight:22, type:"haltères", tech:"Cluster sets" },
      { name:"Cable Fly", sets:4, reps:"12", rest:60, weight:10, type:"machine", tech:"Tension continue" },
      { name:"Leg Press léger", sets:3, reps:"15", rest:60, weight:80, type:"machine", tech:"Standard" },
      { name:"Extension Triceps Corde", sets:5, reps:"12", rest:75, weight:20, type:"machine", tech:"Drop-set" },
      { name:"Lateral Raises", sets:5, reps:"15", rest:75, weight:8, type:"haltères", tech:"Myo-reps" },
      { name:"Face Pull", sets:5, reps:"15", rest:60, weight:20, type:"machine", tech:"Tempo 3-1-2" },
      { name:"Rowing Machine", sets:4, reps:"12", rest:75, weight:50, type:"machine", tech:"Tempo 2-1-2" },
      { name:"Overhead Extension", sets:4, reps:"12", rest:60, weight:15, type:"machine", tech:"Rest-pause" }
    ]
  },
  vendredi: {
    key:'vendredi', 
    title:"Vendredi - Dos + Jambes + Bras + Épaules (73 min)",
    exercises:[
      { name:"Landmine Row", sets:5, reps:"10", rest:105, weight:55, type:"barre", tech:"Tempo 2-1-2" },
      { name:"Leg Curl", sets:5, reps:"12", rest:75, weight:40, type:"machine", tech:"Drop-set dernière série" },
      { name:"Leg Extension", sets:4, reps:"15", rest:75, weight:35, type:"machine", tech:"Standard" },
      { name:"Cable Fly", sets:4, reps:"15", rest:60, weight:10, type:"machine", tech:"Tension continue" },
      { name:"Dumbbell Fly", sets:4, reps:"12", rest:75, weight:10, type:"haltères", tech:"Tempo 3-1-2" },
      { name:"EZ Bar Curl", sets:5, reps:"12", rest:75, weight:25, type:"barre", tech:"Rest-pause" },
      { name:"Overhead Extension", sets:3, reps:"12", rest:75, weight:15, type:"machine", tech:"Rest-pause" },
      { name:"Lateral Raises", sets:3, reps:"15", rest:60, weight:8, type:"haltères", tech:"Myo-reps" },
      { name:"Wrist Curl", sets:3, reps:"20", rest:45, weight:30, type:"barre", tech:"Standard" }
    ]
  }
};
const STATE_KEY = 'hm51_v_full_v6_react';

// --- From components/Icons.tsx ---
const TrophyIcon = () => React.createElement("span", { className: "text-4xl" }, "🏆");
const SettingsIcon = () => React.createElement("span", { className: "text-lg" }, "🧩");
const ChartIcon = () => React.createElement("span", { className: "text-lg" }, "📊");
const HistoryIcon = () => React.createElement("span", { className: "text-lg" }, "📈");
const VolumeIcon = () => React.createElement("span", { className: "text-lg" }, "📈");
const MuscleIcon = () => React.createElement("span", { className: "text-lg" }, "💪");
const ExportIcon = () => React.createElement("span", { className: "text-lg" }, "💾");
const BackupIcon = () => React.createElement("span", { className: "text-lg" }, "☁️");
const ResetIcon = () => React.createElement("span", { className: "text-lg" }, "⚠️");
const AddIcon = () => React.createElement("span", { className: "text-lg" }, "➕");
const ViewIcon = () => React.createElement("span", { className: "text-lg" }, "👁");
const ManageIcon = () => React.createElement("span", { className: "text-lg" }, "📅");
const CreateIndependentIcon = () => React.createElement("span", { className: "text-lg" }, "🌟");
const ChevronDownIcon = () => React.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", className: "h-6 w-6 text-slate-400", fill: "none", viewBox: "0 0 24 24", stroke: "currentColor" }, React.createElement("path", { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M19 9l-7 7-7-7" }));
const ChevronUpIcon = () => React.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", className: "h-6 w-6 text-slate-400", fill: "none", viewBox: "0 0 24 24", stroke: "currentColor" }, React.createElement("path", { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M5 15l7-7 7 7" }));
const CloseIcon = () => React.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", className: "h-6 w-6", fill: "none", viewBox: "0 0 24 24", stroke: "currentColor" }, React.createElement("path", { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M6 18L18 6M6 6l12 12" }));
const SkipIcon = () => React.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", className: "h-6 w-6", fill: "none", viewBox: "0 0 24 24", stroke: "currentColor" }, React.createElement("path", { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M6 18L18 6M6 6l12 12" }));

// --- From components/Modal.tsx ---
const Modal = ({ isOpen, onClose, children, title }) => {
  if (!isOpen) return null;
  return React.createElement("div", { className: "fixed inset-0 z-50 flex items-center justify-center p-4", "aria-modal": "true" },
    React.createElement("div", { className: "absolute inset-0 bg-black/70 backdrop-blur-sm", onClick: onClose }),
    React.createElement("div", { className: "relative z-10 bg-black/80 backdrop-blur-xl border border-white/10 rounded-2xl shadow-2xl max-w-2xl w-full max-h-[85vh] overflow-hidden flex flex-col" },
      React.createElement("header", { className: "flex items-center justify-between p-4 border-b border-white/10" },
        React.createElement("h2", { className: "text-xl font-bold text-amber-400" }, title),
        React.createElement("button", { onClick: onClose, className: "p-1 rounded-full hover:bg-white/10 text-amber-400 transition-colors" }, React.createElement(CloseIcon, null))
      ),
      React.createElement("div", { className: "p-6 overflow-y-auto" }, children)
    )
  );
};

// --- From components/RestTimer.tsx ---
const RestTimer = ({ duration, nextExercise, onSkip, onFinish }) => {
  const [remaining, setRemaining] = useState(duration);
  useEffect(() => {
    if (remaining <= 0) {
      onFinish();
      return;
    }
    const timer = setInterval(() => {
      setRemaining(prev => prev - 1);
    }, 1000);
    return () => clearInterval(timer);
  }, [remaining, onFinish]);
  const radius = 34;
  const circumference = 2 * Math.PI * radius;
  const progress = (remaining / duration) * circumference;
  const minutes = Math.floor(remaining / 60);
  const seconds = remaining % 60;
  return React.createElement("div", { className: "fixed bottom-4 left-1/2 -translate-x-1/2 z-50 flex items-center gap-4 bg-slate-900/80 backdrop-blur-lg border border-white/10 p-3 rounded-2xl shadow-2xl" },
    React.createElement("div", { className: "relative w-16 h-16" },
      React.createElement("svg", { className: "w-full h-full", viewBox: "0 0 80 80" },
        React.createElement("circle", { cx: "40", cy: "40", r: radius, stroke: "rgba(255,255,255,0.1)", strokeWidth: "6", fill: "none" }),
        React.createElement("circle", { cx: "40", cy: "40", r: radius, stroke: "url(#g1)", strokeWidth: "6", fill: "none", strokeLinecap: "round", className: "transform -rotate-90 origin-center transition-all duration-1000 linear", style: { strokeDasharray: circumference, strokeDashoffset: circumference - progress } }),
        React.createElement("defs", null, React.createElement("linearGradient", { id: "g1" }, React.createElement("stop", { offset: "0", stopColor: "#F59E0B" }), React.createElement("stop", { offset: "1", stopColor: "#ff8a00" })))
      ),
      React.createElement("div", { className: "absolute inset-0 flex items-center justify-center font-extrabold text-xl text-amber-400" }, `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`)
    ),
    React.createElement("div", null,
      React.createElement("div", { className: "font-bold text-white" }, nextExercise),
      React.createElement("div", { className: "text-sm text-slate-400" }, "Temps restant")
    ),
    React.createElement("button", { onClick: onSkip, className: "w-11 h-11 flex items-center justify-center rounded-full border-2 border-red-500/30 text-red-500 hover:bg-red-500/20 transition-colors" }, React.createElement(SkipIcon, null))
  );
};

// --- From components/StatsModal.tsx ---
const computeSessionVolumes = (program, weights) => {
  const labels = Object.values(program).map(s => s.title.split(' - ')[0]);
  const volumes = Object.values(program).map(s => {
    return s.exercises.reduce((acc, ex) => {
      const reps = typeof ex.reps === 'number' ? ex.reps : parseInt(String(ex.reps).split('-')[0]) || 0;
      const w = weights[ex.name] || ex.weight || 0;
      return acc + (w * reps * (ex.sets || 0));
    }, 0);
  });
  return labels.map((label, index) => ({ name: label, volume: volumes[index] }));
};
const computeMuscleIntensity = (program, weights) => {
  const map = {};
  Object.values(MUSCLE_MAPPING).forEach(m => {
    [...m.primary, ...m.secondary, ...m.tertiary].forEach(x => { map[x] = 0; });
  });
  Object.values(program).forEach(sess => {
    sess.exercises.forEach(ex => {
      const mm = MUSCLE_MAPPING[ex.name];
      if (!mm) return;
      const weight = weights[ex.name] || ex.weight || 0;
      const reps = typeof ex.reps === 'number' ? ex.reps : parseInt(String(ex.reps).split('-')[0]) || 0;
      const vol = weight * reps * (ex.sets || 0);
      mm.primary.forEach(m => (map[m] = (map[m] || 0) + vol * 1.0));
      mm.secondary.forEach(m => (map[m] = (map[m] || 0) + vol * 0.6));
      mm.tertiary.forEach(m => (map[m] = (map[m] || 0) + vol * 0.3));
    });
  });
  return Object.keys(map).map(l => ({ muscle: l, intensite: Math.round(map[l] / 1000) })).filter(item => item.intensite > 0);
};
const CustomTooltip = ({ active, payload, label }) => {
  if (active && payload && payload.length) {
    return React.createElement("div", { className: "bg-slate-800/80 p-2 border border-slate-600 rounded-lg text-sm" },
      React.createElement("p", { className: "label font-bold text-amber-400" }, `${label}`),
      React.createElement("p", { className: "intro text-white" }, `Volume : ${payload[0].value.toLocaleString()} kg`)
    );
  }
  return null;
};
const StatsModalContent = ({ state }) => {
  const volumeData = computeSessionVolumes(state.program, state.weights);
  const muscleData = computeMuscleIntensity(state.program, state.weights);
  return React.createElement("div", { className: "grid grid-cols-1 lg:grid-cols-2 gap-6" },
    React.createElement("div", { className: "bg-slate-900/50 border border-white/10 rounded-xl p-4" },
      React.createElement("h3", { className: "font-bold text-amber-400 mb-2" }, "Volume hebdomadaire par séance"),
      React.createElement(ResponsiveContainer, { width: "100%", height: 300 },
        React.createElement(BarChart, { data: volumeData, margin: { top: 5, right: 20, left: -10, bottom: 5 } },
          React.createElement(XAxis, { dataKey: "name", stroke: "#94a3b8", fontSize: 12, tickLine: false, axisLine: false }),
          React.createElement(YAxis, { stroke: "#94a3b8", fontSize: 12, tickLine: false, axisLine: false }),
          React.createElement(Tooltip, { content: React.createElement(CustomTooltip, null), cursor: { fill: 'rgba(245, 158, 11, 0.1)' } }),
          React.createElement(Bar, { dataKey: "volume", fill: "#f59e0b", radius: [4, 4, 0, 0] })
        )
      )
    ),
    React.createElement("div", { className: "bg-slate-900/50 border border-white/10 rounded-xl p-4" },
      React.createElement("h3", { className: "font-bold text-amber-400 mb-2" }, "Répartition musculaire (Intensité)"),
      React.createElement(ResponsiveContainer, { width: "100%", height: 300 },
        React.createElement(RadarChart, { cx: "50%", cy: "50%", outerRadius: "80%", data: muscleData },
          React.createElement(PolarGrid, { stroke: "#475569" }),
          React.createElement(PolarAngleAxis, { dataKey: "muscle", stroke: "#e2e8f0", fontSize: 12 }),
          React.createElement(PolarRadiusAxis, { angle: 30, domain: [0, 'dataMax + 10'], stroke: "#94a3b8", fontSize: 10 }),
          React.createElement(Radar, { name: "Intensité", dataKey: "intensite", stroke: "#f59e0b", fill: "#f59e0b", fillOpacity: 0.6 }),
          React.createElement(Tooltip, { wrapperClassName: "!bg-slate-800/80 !border-slate-600 !rounded-lg" })
        )
      )
    )
  );
};

// --- From components/ExerciseCard.tsx ---
const MuscleTag = ({ muscle, type }) => {
  const styles = { primary: 'bg-amber-500/20 text-amber-400', secondary: 'bg-sky-500/20 text-sky-400', tertiary: 'bg-violet-500/20 text-violet-400' };
  return React.createElement("span", { className: `px-2 py-1 text-xs font-semibold rounded-md ${styles[type]}` }, muscle);
};
const SetRow = ({ setIndex, setData, onChange, onCheck }) => {
  const [isChecked, setIsChecked] = useState(false);
  const id = `set-${setIndex}-${Math.random()}`;
  return React.createElement("div", { className: "grid grid-cols-[50px_1fr_1fr_44px] gap-2 items-center bg-white/5 p-2 rounded-lg" },
    React.createElement("span", { className: "text-xs text-slate-400 text-center" }, `Série ${setIndex + 1}`),
    React.createElement("input", { type: "number", step: "0.5", value: setData.w, onChange: (e) => onChange(setIndex, 'w', e.target.value), className: "set-input", placeholder: "KG" }),
    React.createElement("input", { type: "number", value: setData.r, onChange: (e) => onChange(setIndex, 'r', e.target.value), className: "set-input", placeholder: "REPS" }),
    React.createElement("div", { className: "flex justify-center" },
      React.createElement("input", { id: id, type: "checkbox", className: "hidden", checked: isChecked, onChange: (e) => { setIsChecked(e.target.checked); onCheck(e.target.checked); } }),
      React.createElement("label", { htmlFor: id, className: `w-9 h-9 rounded-full border-2 flex items-center justify-center cursor-pointer transition-all duration-200 ${isChecked ? 'bg-emerald-500 border-emerald-500 scale-105' : 'bg-[#121824] border-white/10'}` }, "✓")
    )
  );
};
const ExerciseCard = ({ exercise, currentWeight, lastPerformance, week, onSavePerformance, onWeightChange, onRemove, onStartRest }) => {
  const [isOpen, setIsOpen] = useState(false);
  const [sets, setSets] = useState([]);
  const initialReps = typeof exercise.reps === 'number' ? exercise.reps : parseInt(String(exercise.reps).split('-')[0]) || 0;
  useEffect(() => {
    if (isOpen) {
      setSets(Array.from({ length: exercise.sets }, () => ({ w: currentWeight, r: initialReps })));
    }
  }, [isOpen, exercise.sets, currentWeight, initialReps]);
  const handleSetChange = (index, field, value) => {
    const numericValue = field === 'w' ? parseFloat(value) : parseInt(value, 10);
    const newSets = [...sets];
    newSets[index] = { ...newSets[index], [field]: isNaN(numericValue) ? (field === 'w' ? currentWeight : initialReps) : numericValue };
    setSets(newSets);
  };
  const getTechniqueByWeek = () => {
    if (week <= 5) return ' • Tempo 3-1-2 (Bloc 1)';
    if (week <= 11) return ' • Rest-Pause (Bloc 2)';
    if (week <= 17) return ' • Drop-sets + Myo-reps (Bloc 3)';
    return ' • Clusters + Partials (Bloc 4)';
  }
  const handleSave = () => {
    const validSets = sets.filter(s => s.r > 0);
    if (validSets.length > 0) {
      onSavePerformance(exercise.name, validSets);
      setIsOpen(false);
    } else {
      alert("Entrez au moins une répétition pour enregistrer.");
    }
  };
  const muscleInfo = MUSCLE_MAPPING[exercise.name] || { primary: [], secondary: [], tertiary: [] };
  return React.createElement("div", { className: "rounded-xl border border-white/5 bg-gradient-to-b from-[#0d111a] to-[#121824] overflow-hidden shadow-lg" },
    React.createElement("header", { className: "flex justify-between items-center p-4 cursor-pointer", onClick: () => setIsOpen(!isOpen) },
      React.createElement("div", { className: "flex-1" },
        React.createElement("h3", { className: "font-bold text-amber-400 text-lg" }, exercise.name),
        React.createElement("p", { className: "text-sm text-slate-400" }, `${exercise.sets} × ${exercise.reps} • ${exercise.rest}s repos • ${currentWeight}kg`)
      ),
      isOpen ? React.createElement(ChevronUpIcon, null) : React.createElement(ChevronDownIcon, null)
    ),
    isOpen && React.createElement("div", { className: "px-4 pb-4 bg-white/5" },
      React.createElement("div", { className: "py-3 space-y-3" },
        React.createElement("div", { className: "text-center font-bold text-amber-300 bg-amber-500/10 border border-amber-500/20 rounded-lg py-2 px-3" }, `✨ ${exercise.tech}${getTechniqueByWeek()}`),
        lastPerformance ? React.createElement("div", { className: "text-sm bg-emerald-500/10 border border-emerald-500/20 text-emerald-300 rounded-lg p-3" }, `Dernière perf: ${lastPerformance.weight}kg × ${lastPerformance.reps} reps (Semaine ${lastPerformance.week})`)
          : React.createElement("div", { className: "text-sm bg-amber-500/10 border border-amber-500/20 text-amber-300 rounded-lg p-3" }, "Première fois pour cet exercice."),
        React.createElement("div", { className: "flex gap-2 flex-wrap" },
          muscleInfo.primary.map(m => React.createElement(MuscleTag, { key: m, muscle: m, type: "primary" })),
          muscleInfo.secondary.map(m => React.createElement(MuscleTag, { key: m, muscle: m, type: "secondary" })),
          muscleInfo.tertiary.map(m => React.createElement(MuscleTag, { key: m, muscle: m, type: "tertiary" }))
        ),
        React.createElement("div", { className: "space-y-2" },
          sets.map((set, i) => React.createElement(SetRow, {
            key: i, setIndex: i, setData: set, onChange: handleSetChange,
            onCheck: (isChecked) => {
              if (isChecked) {
                const isLast = i === exercise.sets - 1;
                onStartRest(exercise.rest, isLast ? 'Prochain exercice' : `Repos - ${exercise.name}`);
              }
            }
          }))
        ),
        React.createElement("div", { className: "flex flex-wrap gap-2 pt-2" },
          React.createElement("button", { onClick: () => onWeightChange(exercise.name), className: "btn-ios" }, "✏️ Poids"),
          React.createElement("button", { onClick: handleSave, className: "btn-ios bg-sky-600 hover:bg-sky-500 text-white shadow-sky-500/30" }, "💾 Enregistrer"),
          React.createElement("button", { onClick: () => onRemove(exercise.name), className: "btn-ios bg-red-600 hover:bg-red-500 text-white shadow-red-500/30" }, "🗑️ Retirer")
        )
      )
    )
  );
};

// --- From components/PremiumHeatmap.tsx ---
const heatmap_parseHistory = (hist) => { return Object.values(hist).flat(); };
const heatmap_normalizeEntry = (e) => ({ ...e, _date: e.ts ? new Date(e.ts) : new Date() });
const heatmap_dayKey = (d) => `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, '0')}-${String(d.getDate()).padStart(2, '0')}`;
const heatmap_addDays = (d, n) => { const r = new Date(d); r.setDate(r.getDate() + n); return r; };
const heatmap_startOfWeek = (d) => { const r = new Date(d); const day = r.getDay(); const diff = r.getDate() - day + (day === 0 ? -6 : 1); r.setDate(diff); r.setHours(0, 0, 0, 0); return r; };
const heatmap_computeMap = (hist) => {
  const map = {};
  hist.forEach(h => {
    const e = heatmap_normalizeEntry(h);
    if (!e._date) return;
    const k = heatmap_dayKey(e._date);
    if (!map[k]) map[k] = { v: 0, s: 0, entries: [] };
    if (e.allSets) { e.allSets.forEach(s => { map[k].v += (s.w || 0) * (s.r || 0); map[k].s += 1; }); }
    map[k].entries.push(e);
  });
  return map;
};
const heatmap_getIntensityClass = (v, max) => {
  if (v === 0) return 'bg-slate-800/80 text-slate-500';
  if (max <= 0) return 'bg-slate-800/80 text-slate-500';
  const r = v / max;
  if (r <= 0.15) return 'bg-gradient-to-br from-slate-700 to-slate-800 shadow-inner shadow-sky-500/30';
  if (r <= 0.45) return 'bg-gradient-to-br from-sky-600 to-blue-700 shadow-inner shadow-blue-500/40';
  if (r <= 0.75) return 'bg-gradient-to-br from-amber-500 to-orange-600 text-black shadow-lg shadow-amber-500/40';
  return 'bg-gradient-to-br from-red-500 to-amber-600 text-black shadow-lg shadow-red-500/40';
};
const PremiumHeatmap = ({ history, onDayClick }) => {
  const [refDate, setRefDate] = useState(heatmap_startOfWeek(new Date()));
  const processedHistory = useMemo(() => heatmap_parseHistory(history), [history]);
  const historyMap = useMemo(() => heatmap_computeMap(processedHistory), [processedHistory]);
  const heatmapData = useMemo(() => {
    const vols = Object.values(historyMap).map(x => x.v);
    const maxVolume = Math.max(1, ...vols);
    const weeks = [];
    for (let w = 0; w < 4; w++) {
      const weekStart = heatmap_addDays(refDate, w * 7);
      const days = [];
      for (let d = 0; d < 7; d++) {
        const day = heatmap_addDays(weekStart, d);
        const k = heatmap_dayKey(day);
        const m = historyMap[k] || { v: 0, s: 0, entries: [] };
        days.push({ d: day, v: m.v, s: m.s, e: m.entries });
      }
      weeks.push(days);
    }
    return { weeks, maxVolume };
  }, [refDate, historyMap]);
  const handlePrev = useCallback(() => setRefDate(prev => heatmap_addDays(prev, -28)), []);
  const handleNext = useCallback(() => setRefDate(prev => heatmap_addDays(prev, 28)), []);
  const startLabel = heatmapData.weeks[0][0].d.toLocaleDateString('fr-FR', { day: '2-digit', month: 'short' });
  const endLabel = heatmapData.weeks[3][6].d.toLocaleDateString('fr-FR', { day: '2-digit', month: 'short' });
  return React.createElement("div", { className: "bg-black/30 backdrop-blur-lg border border-white/10 rounded-2xl p-4 md:p-6 shadow-2xl" },
    React.createElement("h3", { className: "text-lg font-black text-amber-400 mb-4 text-shadow-lg shadow-amber-500/50" }, "Heatmap • Charge d'entraînement"),
    React.createElement("div", { className: "flex justify-between items-center gap-2 flex-wrap mb-4" },
      React.createElement("div", { className: "flex items-center gap-2 bg-white/5 border border-white/10 rounded-lg p-1" },
        React.createElement("button", { onClick: handlePrev, className: "btn-ios-small" }, "‹ Préc."),
        React.createElement("span", { className: "text-sm font-semibold px-2 text-slate-300 whitespace-nowrap" }, `${startLabel} – ${endLabel}`),
        React.createElement("button", { onClick: handleNext, className: "btn-ios-small" }, "Suiv. ›")
      )
    ),
    React.createElement("div", { className: "grid grid-cols-7 gap-1.5 md:gap-2" },
      ['Lun', 'Mar', 'Mer', 'Jeu', 'Ven', 'Sam', 'Dim'].map(day => React.createElement("div", { key: day, className: "text-center text-xs font-bold text-slate-400 pb-1" }, day)),
      heatmapData.weeks.flat().map((dayData, i) => {
        const volumeText = dayData.v > 999 ? `${(dayData.v / 1000).toFixed(1)}k` : Math.round(dayData.v);
        return React.createElement("div", { key: i, className: `h-16 md:h-20 rounded-lg flex flex-col items-center justify-center cursor-pointer transition-transform duration-200 hover:scale-105 hover:shadow-2xl ${heatmap_getIntensityClass(dayData.v, heatmapData.maxVolume)}`, onClick: () => onDayClick(dayData) },
          React.createElement("div", { className: "font-bold text-lg" }, dayData.d.getDate()),
          React.createElement("div", { className: "text-xs opacity-80" }, `${volumeText} kg`)
        );
      })
    ),
    React.createElement("div", { className: "flex justify-center flex-wrap gap-2 mt-4 text-xs text-slate-400" },
      React.createElement("div", { className: "flex items-center gap-1.5" }, React.createElement("div", { className: "w-3 h-3 rounded-sm bg-slate-700" }), "Faible"),
      React.createElement("div", { className: "flex items-center gap-1.5" }, React.createElement("div", { className: "w-3 h-3 rounded-sm bg-sky-600" }), "Moyen"),
      React.createElement("div", { className: "flex items-center gap-1.5" }, React.createElement("div", { className: "w-3 h-3 rounded-sm bg-amber-500" }), "Haut"),
      React.createElement("div", { className: "flex items-center gap-1.5" }, React.createElement("div", { className: "w-3 h-3 rounded-sm bg-red-500" }), "Max")
    )
  );
};

// --- From App.tsx ---
const defaultState = () => {
  const weights = {};
  Object.values(PROGRAM).forEach(s => s.exercises.forEach(e => { weights[e.name] = e.weight; }));
  return { week: 1, program: JSON.parse(JSON.stringify(PROGRAM)), weights: weights, hist: {}, customExercises: [] };
};
const App = () => {
  const [state, setState] = useState(() => { try { const raw = localStorage.getItem(STATE_KEY); return raw ? JSON.parse(raw) : defaultState(); } catch (e) { console.error("Erreur chargement state:", e); return defaultState(); } });
  const [currentSessionKey, setCurrentSessionKey] = useState(null);
  const [restTimer, setRestTimer] = useState(null);
  const [modal, setModal] = useState(null);
  const [quickMsg, setQuickMsg] = useState(null);
  useEffect(() => { try { localStorage.setItem(STATE_KEY, JSON.stringify(state)); } catch (e) { console.error("Erreur sauvegarde state:", e); } }, [state]);
  useEffect(() => { if (quickMsg) { const timer = setTimeout(() => setQuickMsg(null), 2800); return () => clearTimeout(timer); } }, [quickMsg]);
  const showQuick = (text, color = 'text-green-400') => setQuickMsg({ text, color });
  const handleWeekChange = (direction) => setState(prev => ({ ...prev, week: Math.max(1, prev.week + direction) }));
  const handleSavePerformance = (exerciseName, sets) => {
    const best = sets.reduce((a, b) => b.r * b.w > a.r * a.w ? b : a, sets[0]);
    const newEntry = { week: state.week, weight: best.w, reps: best.r, ts: Date.now(), allSets: sets };
    setState(prev => ({ ...prev, hist: { ...prev.hist, [exerciseName]: [...(prev.hist[exerciseName] || []), newEntry] }, weights: { ...prev.weights, [exerciseName]: best.w } }));
    showQuick(`✅ ${exerciseName}: ${best.r} reps @ ${best.w}kg enregistré`);
  };
  const handleRemoveExercise = (exerciseName) => {
    if (currentSessionKey && window.confirm(`Retirer "${exerciseName}" de cette séance ?`)) {
      setState(prev => {
        const newProgram = { ...prev.program };
        newProgram[currentSessionKey].exercises = newProgram[currentSessionKey].exercises.filter(ex => ex.name !== exerciseName);
        return { ...prev, program: newProgram };
      });
      showQuick('Exercice retiré', 'text-red-400');
    }
  };
  const handleReset = () => {
    if (window.confirm('Réinitialiser toutes les données? Cette action est irréversible.')) {
      localStorage.removeItem(STATE_KEY);
      setState(defaultState());
      setCurrentSessionKey(null);
      showQuick('Application réinitialisée', 'text-red-400');
    }
  };
  const handleExport = () => {
    let csv = 'Exercise,Week,Set,Reps,Weight,Date\n';
    Object.entries(state.hist).forEach(([ex, arr]) => {
      arr.forEach(r => {
        if (r.allSets && r.allSets.length) {
          r.allSets.forEach((s, idx) => { csv += `"${ex}",${r.week},${idx + 1},${s.r},${s.w},"${new Date(r.ts).toLocaleString()}"\n`; });
        }
      });
    });
    const blob = new Blob([csv], { type: 'text/csv' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a'); a.href = url; a.download = `ultimate_export_${new Date().toISOString().slice(0, 10)}.csv`; a.click(); URL.revokeObjectURL(url); showQuick('CSV exporté');
  };
  const handleBackup = () => {
    const dataStr = JSON.stringify(state, null, 2);
    const blob = new Blob([dataStr], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a'); a.href = url; a.download = `hm51_backup_${new Date().toISOString().slice(0, 10)}.json`; a.click(); URL.revokeObjectURL(url); showQuick('Sauvegarde téléchargée');
  };
  const handleOpenWeightModal = (exerciseName) => {
    const currentWeight = state.weights[exerciseName] || 0;
    const SaveButton = () => {
      const newWeight = parseFloat(document.getElementById('new-weight-input').value);
      if (!isNaN(newWeight) && newWeight >= 0) {
        setState(prev => ({ ...prev, weights: { ...prev.weights, [exerciseName]: newWeight } }));
        setModal(null); showQuick(`Poids de ${exerciseName} mis à jour.`);
      } else { alert('Poids invalide.'); }
    };
    setModal({
      title: `Modifier le poids pour ${exerciseName}`,
      content: React.createElement("div", null,
        React.createElement("input", { id: "new-weight-input", type: "number", defaultValue: currentWeight, className: "set-input w-full text-lg p-3", autoFocus: true }),
        React.createElement("div", { className: "flex gap-2 mt-4" },
          React.createElement("button", { onClick: SaveButton, className: "btn-ios bg-sky-600 hover:bg-sky-500 text-white shadow-sky-500/30" }, "Enregistrer"),
          React.createElement("button", { onClick: () => setModal(null), className: "btn-ios" }, "Annuler")
        )
      )
    });
  };
  const blockName = useMemo(() => {
    if (state.week <= 5) return 'Bloc 1 - Fondation • Tempo contrôlé';
    if (state.week <= 11) return 'Bloc 2 - Surcharge • Rest-Pause';
    if (state.week <= 17) return 'Bloc 3 - Surcompensation • Drop-sets + Myo-reps';
    return 'Bloc 4 - Intensification • Clusters + Partials';
  }, [state.week]);
  const handleOpenStats = () => setModal({ title: `Statistiques • Semaine ${state.week}`, content: React.createElement(StatsModalContent, { state: state }) });
  const handleDayClick = (data) => {
    if (data.e.length === 0) return;
    setModal({
      title: `Détails du ${data.d.toLocaleDateString('fr-FR', { weekday: 'long', day: 'numeric', month: 'long' })}`,
      content: React.createElement("div", { className: "text-white" },
        React.createElement("p", { className: "font-bold" }, `Volume: ${Math.round(data.v).toLocaleString()} kg`),
        React.createElement("p", null, `Séries totales: ${data.s}`),
        React.createElement("ul", { className: "list-disc pl-5 mt-4 space-y-1" },
          data.e.flatMap(entry => entry.allSets.map((set, i) => React.createElement("li", { key: `${entry.ts}-${i}` }, `${entry.name || 'Exercice'}: ${set.r} reps @ ${set.w}kg`)))
        )
      )
    });
  };
  const currentSession = currentSessionKey ? state.program[currentSessionKey] : null;
  return React.createElement("div", { className: "max-w-7xl mx-auto p-3 md:p-6 text-slate-200" },
    React.createElement("header", { className: "flex items-center gap-4 mb-6" },
      React.createElement(TrophyIcon, null),
      React.createElement("div", null,
        React.createElement("h1", { className: "text-2xl font-black bg-gradient-to-r from-amber-400 to-orange-500 text-transparent bg-clip-text" }, "HYBRID MASTER 51 — Ultimate V6"),
        React.createElement("p", { className: "text-sm text-slate-400" }, "26 semaines · 3 séances / semaine · Analyse & Heatmap")
      )
    ),
    React.createElement("div", { className: "grid grid-cols-1 lg:grid-cols-3 gap-6" },
      React.createElement("main", { className: "lg:col-span-2 space-y-6" },
        React.createElement("div", { className: "flex justify-between items-center bg-[#0d111a] p-4 rounded-xl border border-white/5 shadow-lg" },
          React.createElement("div", null,
            React.createElement("div", { className: "text-xl font-bold" }, "Semaine ", React.createElement("span", { className: "text-amber-400" }, state.week)),
            React.createElement("div", { className: "text-xs text-slate-400" }, blockName)
          ),
          React.createElement("div", { className: "flex gap-2" },
            React.createElement("button", { onClick: () => handleWeekChange(-1), className: "btn-ios" }, "← Préc."),
            React.createElement("button", { onClick: () => handleWeekChange(1), className: "btn-ios bg-sky-600 hover:bg-sky-500 text-white shadow-sky-500/30" }, "Suiv. →")
          )
        ),
        !currentSessionKey ? React.createElement("div", { className: "bg-[#0d111a] p-4 rounded-xl border border-white/5 shadow-lg" },
          React.createElement("h2", { className: "font-bold text-lg mb-4" }, "Séances disponibles"),
          React.createElement("div", { className: "space-y-3" },
            Object.values(state.program).map(session => React.createElement("button", { key: session.key, onClick: () => setCurrentSessionKey(session.key), className: "w-full text-left p-4 rounded-lg bg-gradient-to-r from-amber-500 to-orange-500 text-black font-bold shadow-lg shadow-amber-500/20 hover:scale-105 hover:shadow-xl hover:shadow-amber-500/40 transition-all duration-200" },
              React.createElement("div", null, session.title),
              React.createElement("div", { className: "text-sm font-semibold opacity-80" }, `${session.exercises.length} exercices • ${session.exercises.reduce((acc, ex) => acc + ex.sets, 0)} séries`)
            ))
          )
        ) : React.createElement("div", null,
          React.createElement("div", { className: "flex justify-between items-center mb-4" },
            React.createElement("h2", { className: "text-xl font-bold" }, currentSession.title),
            React.createElement("button", { onClick: () => setCurrentSessionKey(null), className: "btn-ios" }, "← Retour aux séances")
          ),
          React.createElement("div", { className: "space-y-4" },
            currentSession.exercises.map(ex => React.createElement(ExerciseCard, { key: ex.name, exercise: ex, currentWeight: state.weights[ex.name] || ex.weight, lastPerformance: (state.hist[ex.name] || []).slice(-1)[0], week: state.week, onSavePerformance: handleSavePerformance, onWeightChange: handleOpenWeightModal, onRemove: handleRemoveExercise, onStartRest: (duration, nextExercise) => setRestTimer({ duration, nextExercise }) }))
          )
        )
      ),
      React.createElement("aside", { className: "space-y-6" },
        React.createElement("div", { className: "bg-[#0d111a] p-4 rounded-xl border border-white/5 shadow-lg" },
          React.createElement("h3", { className: "font-bold text-lg" }, "Tableau de bord"),
          React.createElement("p", { className: `text-sm mt-2 h-5 transition-opacity duration-300 ${quickMsg ? 'opacity-100' : 'opacity-0'}` }, React.createElement("span", { className: quickMsg?.color }, quickMsg?.text)),
          React.createElement("div", { className: "grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-2 gap-2 mt-3" },
            React.createElement("button", { onClick: handleOpenStats, className: "btn-dashboard" }, React.createElement(ChartIcon, null), " Statistiques"),
            React.createElement("button", { onClick: handleExport, className: "btn-dashboard" }, React.createElement(ExportIcon, null), " Export"),
            React.createElement("button", { onClick: handleBackup, className: "btn-dashboard" }, React.createElement(BackupIcon, null), " Backup"),
            React.createElement("button", { onClick: handleReset, className: "btn-dashboard text-red-400" }, React.createElement(ResetIcon, null), " Reset")
          )
        ),
        React.createElement("div", { className: "bg-[#0d111a] p-4 rounded-xl border border-white/5 shadow-lg" },
          React.createElement("h3", { className: "font-bold text-lg mb-2" }, "Gestion des Exercices"),
          React.createElement("p", { className: "text-sm text-slate-400 mb-3" }, `${state.customExercises.length} exercices personnalisés`),
          React.createElement("div", { className: "grid grid-cols-2 gap-2" },
            React.createElement("button", { className: "btn-dashboard" }, React.createElement(AddIcon, null), "Ajouter"),
            React.createElement("button", { className: "btn-dashboard" }, React.createElement(ViewIcon, null), "Voir"),
            React.createElement("button", { className: "btn-dashboard col-span-2" }, React.createElement(CreateIndependentIcon, null), "Créer Indépendant")
          )
        )
      )
    ),
    React.createElement("div", { className: "mt-6" }, React.createElement(PremiumHeatmap, { history: state.hist, onDayClick: handleDayClick })),
    React.createElement("footer", { className: "text-center mt-8 text-sm text-slate-500" }, `© ${new Date().getFullYear()} — HYBRID MASTER 51 — Ultimate V6`),
    restTimer && React.createElement(RestTimer, { duration: restTimer.duration, nextExercise: restTimer.nextExercise, onFinish: () => { setRestTimer(null); showQuick('⏱️ Repos terminé!', 'text-amber-400'); try { navigator.vibrate([100, 50, 100]); } catch (e) { } }, onSkip: () => setRestTimer(null) }),
    React.createElement(Modal, { isOpen: !!modal, onClose: () => setModal(null), title: modal?.title || '' }, modal?.content),
    React.createElement("style", null, `
      .btn-ios { background: linear-gradient(135deg, #f59e0b, #f97316); color: black; border: none; font-weight: 700; transition: all 0.25s ease; box-shadow: 0 4px 16px rgba(249, 115, 22, 0.3); border-radius: 12px; padding: 10px 16px; cursor: pointer; }
      .btn-ios:hover { transform: translateY(-2px); box-shadow: 0 6px 24px rgba(249, 115, 22, 0.5); }
      .btn-ios-small { background: rgba(255,255,255,0.08); border: 1px solid rgba(255,255,255,0.08); padding: 8px 12px; border-radius: 8px; color: #fff; font-weight: 600; cursor: pointer; transition: all 0.2s; }
      .btn-ios-small:hover { background: rgba(255,255,255,0.18); }
      .btn-dashboard { display: flex; align-items: center; gap: 8px; padding: 8px 12px; background: #121824; border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; font-weight: 600; transition: all 0.2s; }
      .btn-dashboard:hover { background: #1e293b; color: #f59e0b; }
      .set-input { background: rgba(255,255,255,0.04); border: 1px solid rgba(255,255,255,0.08); padding: 10px 12px; border-radius: 10px; color: #fff; font-weight: 600; text-align: center; font-size: 14px; transition: all 0.25s; height: 42px; box-shadow: inset 0 2px 4px rgba(0,0,0,0.1); }
      .set-input:focus { outline: none; border-color: #f59e0b; box-shadow: 0 0 10px rgba(245, 158, 11, 0.4), inset 0 2px 4px rgba(0,0,0,0.1); }
    `)
  );
};
const rootElement = document.getElementById('root');
if (!rootElement) {
  throw new Error("Could not find root element to mount to");
}
const root = ReactDOM.createRoot(rootElement);
root.render(React.createElement(React.StrictMode, null, React.createElement(App, null)));

// --- BUNDLED SCRIPT END ---
    </script>
  </body>
</html>
